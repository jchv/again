This code is copied from the Moby Project and is licensed under the Apache 2.0 license.
